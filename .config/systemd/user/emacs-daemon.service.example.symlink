# IMPORTANT: you have to COPY or HARDLINK this file to
# ~/.config/systemd/user, just symlinking will not work
# and fail with E_NOENT.
#
# Except if you’re on NixOS. ♥

[Unit]
Description=Emacs: the extensible, self-documenting text editor

[Service]
Type=forking
ExecStart=/bin/sh -c '. /etc/profile ; . "%h/.profile" ; rm "%h/.emacs.d/.emacs.desktop.lock" || true ; exec emacs --daemon'
ExecStop=/bin/sh -c 'emacsclient --eval "(kill-emacs)"'
Restart=always

[Install]
WantedBy=default.target
